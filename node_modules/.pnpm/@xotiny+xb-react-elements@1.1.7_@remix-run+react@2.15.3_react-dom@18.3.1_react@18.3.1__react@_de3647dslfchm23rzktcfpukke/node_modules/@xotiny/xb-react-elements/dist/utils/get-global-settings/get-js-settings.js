import { fieldControlValuesToVariables } from './field-control-values-to-variables';
/*
  - Input: {
    "animate": {
      "animate-duration": {
        "desktop": {
          "value": 500,
          "unit": "ms"
        }
      },
      "animate-effect": "none",
      "animate-strength": {
        "desktop": {
            "value": 1
        }
      }
    },
    customCode: {
      "css": ".class_from_custom_css { color: red; }",
      "js": "console.log(\"hello from useGlobalSettings\");"
    }
  };

  - Output:
    `
      window.settings = {
        animate-duration-desktop: 500ms,
        animate-effect: none,
        animate-strength-desktop: 1
      }
      console.log("hello from useGlobalSettings");
    `
*/
/** Hàm lấy js của global settings hoặc page settings, đầu ra là `js: string` | Hiện tại đang lấy các field: *animate | customCode*  */
export function getGlobalJsSettings(globalOrPageSettings) {
    let customJs = '';
    let resultAnimate = {};
    Object.keys(globalOrPageSettings).forEach(key => {
        if (key === 'animate') {
            resultAnimate = {
                ...resultAnimate,
                ...fieldControlValuesToVariables(globalOrPageSettings[key], '', false),
            };
        }
        if (key === 'customCode') {
            const { js } = globalOrPageSettings[key];
            customJs = js;
        }
    });
    /* eslint newline-per-chained-call: 0 */
    return `
    window.settings = {
      ${JSON.stringify(resultAnimate, null, 2).replace(/"/g, "'").replace(/^{/, '').replace(/}$/, '')}
    };
    ${customJs}
  `;
}
